<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Journey - Mountain Climber</title>
    <style>
        body { 
            margin: 0; overflow: hidden; 
            background: linear-gradient(180deg, #2f4f4f 0%, #708090 30%, #b0c4de 60%, #e6e6fa 100%);
            animation: altitudeShift 12s infinite;
        }
        canvas { display: block; }
        .title { 
            position: absolute; top: 25px; left: 50%; transform: translateX(-50%); 
            color: #f5f5dc; font-family: 'Arial Black', sans-serif; font-size: 40px; 
            letter-spacing: 4px; text-shadow: 3px 3px 8px rgba(0,0,0,0.9);
            text-transform: uppercase;
        }
        .climb-phase {
            position: absolute; top: 70px; left: 50%; transform: translateX(-50%);
            color: #fffaf0; font-family: 'Trebuchet MS', sans-serif; font-size: 18px; 
            font-weight: bold; letter-spacing: 2px; text-shadow: 2px 2px 6px rgba(0,0,0,0.8);
        }
        .altitude {
            position: absolute; bottom: 30px; right: 30px;
            color: #87ceeb; font-family: monospace; font-size: 14px;
            background: rgba(0,0,0,0.5); padding: 10px; border-radius: 5px;
        }
        @keyframes altitudeShift {
            0%, 100% { filter: brightness(0.8) contrast(1.2); }
            50% { filter: brightness(1.1) contrast(0.9); }
        }
    </style>
</head>
<body>
    <div class="title">MOUNTAIN CLIMBER</div>
    <div class="climb-phase" id="climbPhase">BASE CAMP PREPARATION</div>
    <div class="altitude" id="altitude">Altitude: 2,000m</div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="../particle-being-library.js"></script>
    <script>
        let scene, camera, renderer, particleSystem;
        let time = 0;
        let currentPhase = 0;
        let phaseTimer = 0;
        let mountain = [];
        let gear = [];
        let weather = [];
        let rocks = [];
        
        const climbPhases = [
            'BASE CAMP PREPARATION', 'GENTLE ASCENT', 'STEEP ROCKY CLIMB', 'ICE WALL SCALING',
            'AVALANCHE SURVIVAL', 'SUMMIT PUSH', 'PEAK TRIUMPH'
        ];

        const altitudes = ['2,000m', '3,500m', '5,200m', '6,800m', '7,500m', '8,400m', '8,848m'];

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 10, 30);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Create determined climber particle system
            particleSystem = new ParticleBeingSystem(scene, {
                particleCount: 280,
                particleSize: 0.09,
                speedMultiplier: 1.8,
                colorRange: { h: 0.02, s: 0.6, lMin: 0.4, lMax: 0.7 }
            });

            createClimber();
            createMountainEnvironment();
            animate();
        }

        function createClimber() {
            const climber = particleSystem.convertToParticleBeing(
                null,
                { x: 0, y: -2, z: 0 },
                {
                    particleCount: 320,
                    states: ['preparing', 'ascending', 'struggling', 'triumphing'],
                    stateTimings: { preparing: 4, ascending: 5, struggling: 3, triumphing: 4 },
                    attractionForces: { preparing: 0.03, ascending: 0.02, struggling: 0.015, triumphing: 0.025 }
                }
            );

            // 7 distinct climbing challenges with extreme differences
            const originalUpdate = particleSystem.updateBeing.bind(particleSystem);
            particleSystem.updateBeing = function(being, deltaTime) {
                originalUpdate(being, deltaTime);
                
                phaseTimer += deltaTime;
                if (phaseTimer > 7) {
                    currentPhase = (currentPhase + 1) % climbPhases.length;
                    phaseTimer = 0;
                    document.getElementById('climbPhase').textContent = climbPhases[currentPhase];
                    document.getElementById('altitude').textContent = `Altitude: ${altitudes[currentPhase]}`;
                }
                
                switch(currentPhase) {
                    case 0: // BASE CAMP PREPARATION - Small, methodical, gear gathering
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(0.6); // Compact, efficient
                            
                            // Methodical preparation movements
                            particle.userData.velocity.multiplyScalar(0.4); // Very slow, deliberate
                            
                            // Gear checking motions
                            if (i > 100 && i < 140) { // Arms
                                particle.userData.targetPosition.x += Math.sin(time * 3 + i * 0.1) * 0.8;
                                particle.userData.targetPosition.y += Math.cos(time * 4 + i * 0.1) * 0.5;
                            }
                            
                            // Crouching to check equipment
                            particle.userData.targetPosition.y *= 0.8;
                            
                            // Focused concentration color
                            particle.material.color.setHSL(0.15, 0.7, 0.6);
                            particle.material.opacity = 0.9;
                        });
                        
                        // Create gear particles
                        if (Math.random() < 0.04) {
                            createGearItem(being.userData.basePosition);
                        }
                        
                        being.userData.basePosition.set(0, -2, 0);
                        
                        // Close preparation view
                        camera.position.set(4, 2, 15);
                        camera.lookAt(0, -1, 0);
                        break;
                        
                    case 1: // GENTLE ASCENT - Medium size, steady rhythm
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(0.8);
                            
                            // Steady hiking rhythm
                            const hikingRhythm = time * 4;
                            particle.userData.velocity.y += Math.sin(hikingRhythm) * 0.001;
                            particle.userData.velocity.z -= 0.01; // Moving toward mountain
                            
                            // Walking motion
                            if (i > 200) { // Legs
                                particle.userData.targetPosition.x += Math.sin(hikingRhythm + i) * 0.3;
                                particle.userData.targetPosition.y += Math.abs(Math.sin(hikingRhythm * 2)) * 0.2;
                            }
                            
                            // Arm swinging
                            if (i > 100 && i < 150) {
                                particle.userData.targetPosition.x += Math.sin(hikingRhythm + Math.PI) * 0.5;
                            }
                            
                            // Fresh energy color
                            particle.material.color.setHSL(0.1, 0.8, 0.7);
                        });
                        
                        being.userData.basePosition.y += 0.02; // Gradual ascent
                        being.userData.basePosition.z -= 0.05;
                        
                        // Following trail camera
                        camera.position.set(-8, being.userData.basePosition.y + 5, 20);
                        camera.lookAt(being.userData.basePosition);
                        break;
                        
                    case 2: // STEEP ROCKY CLIMB - Larger, stretched, gripping motions
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(1.1); // More muscular effort
                            
                            // Vertical climbing stretch
                            particle.scale.y = 1.8;
                            particle.scale.x = 0.7;
                            
                            // Rock gripping motion
                            if (i > 80 && i < 140) { // Arms
                                particle.userData.velocity.y += 0.02;
                                particle.userData.targetPosition.x += Math.sin(time * 8 + i) * 0.4;
                                particle.userData.targetPosition.y += Math.cos(time * 6 + i) * 0.3;
                                
                                // Grip strain
                                particle.material.color.setHSL(0.05, 0.9, 0.5); // Red strain
                                particle.scale.setScalar(1.4); // Bulging muscles
                            }
                            
                            // Leg pushing motion
                            if (i > 200) {
                                particle.userData.velocity.y += 0.015;
                                particle.userData.targetPosition.x += Math.cos(time * 7 + i) * 0.3;
                            }
                            
                            // Finding handholds
                            if (Math.random() < 0.02) {
                                createHandhold(particle.position);
                            }
                        });
                        
                        being.userData.basePosition.y += 0.08;
                        being.userData.basePosition.z -= 0.02;
                        
                        // Close cliff face camera
                        camera.position.set(12, being.userData.basePosition.y, being.userData.basePosition.z + 8);
                        camera.lookAt(being.userData.basePosition);
                        break;
                        
                    case 3: // ICE WALL SCALING - Very slow, methodical, ice pick motions
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(1.3); // Bulky gear
                            
                            // Extremely slow, methodical movement
                            particle.userData.velocity.multiplyScalar(0.2);
                            
                            // Ice pick swinging
                            if (i > 90 && i < 130) { // Arms with ice tools
                                const pickSwing = Math.sin(time * 6 + i * 0.5);
                                if (pickSwing > 0.8) {
                                    particle.userData.velocity.y += 0.05;
                                    particle.scale.setScalar(2.0); // Power swing
                                    particle.userData.targetPosition.y += 1.5;
                                    particle.userData.targetPosition.x += pickSwing * 1.2;
                                }
                            }
                            
                            // Crampon kicking
                            if (i > 220 && Math.sin(time * 5 + i) > 0.7) {
                                particle.userData.velocity.y += 0.03;
                                particle.userData.targetPosition.y += 0.8;
                            }
                            
                            // Ice cold blue tint
                            particle.material.color.setHSL(0.6, 0.8, 0.4 + Math.sin(time * 10) * 0.1);
                            
                            // Breathing vapor
                            if (i < 40 && Math.random() < 0.1) { // Head
                                createBreathVapor(particle.position);
                            }
                        });
                        
                        being.userData.basePosition.y += 0.03;
                        
                        // Ice wall dramatic angle
                        camera.position.set(-15, being.userData.basePosition.y + 8, 10);
                        camera.lookAt(being.userData.basePosition);
                        break;
                        
                    case 4: // AVALANCHE SURVIVAL - Chaotic, fast evasion, survival instincts
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(1.5); // Panic expansion
                            
                            // Chaotic survival motion
                            particle.userData.velocity.x += (Math.random() - 0.5) * 0.15;
                            particle.userData.velocity.y += (Math.random() - 0.5) * 0.1;
                            particle.userData.velocity.z += Math.random() * 0.1; // Escape motion
                            
                            // Desperate reaching
                            if (i > 100 && i < 150) {
                                particle.userData.targetPosition.x += (Math.random() - 0.5) * 3;
                                particle.userData.targetPosition.y += Math.random() * 2;
                            }
                            
                            // Survival color - adrenaline yellow
                            particle.material.color.setHSL(0.12, 0.9, 0.8);
                            particle.material.opacity = 0.6 + Math.random() * 0.4;
                            
                            // Speed blur effect
                            particle.scale.x = 2.5;
                            particle.scale.y = 0.8;
                        });
                        
                        // Rapid escape movement
                        being.userData.basePosition.x += Math.sin(time * 20) * 0.5;
                        being.userData.basePosition.z += 0.3;
                        being.userData.basePosition.y -= 0.1; // Sliding down
                        
                        // Chaotic camera shake
                        camera.position.set(
                            being.userData.basePosition.x + (Math.random() - 0.5) * 10,
                            being.userData.basePosition.y + 15 + (Math.random() - 0.5) * 5,
                            being.userData.basePosition.z + 25
                        );
                        camera.lookAt(being.userData.basePosition);
                        
                        // Create avalanche debris
                        if (Math.random() < 0.2) {
                            createAvalancheDebris(being.userData.basePosition);
                        }
                        break;
                        
                    case 5: // SUMMIT PUSH - Exhausted but determined, thin air effects
                        being.particles.forEach((particle, i) => {
                            particle.scale.setScalar(0.9); // Exhausted, smaller
                            
                            // Exhaustion - very slow movement
                            particle.userData.velocity.multiplyScalar(0.15);
                            
                            // Labored breathing effect
                            const breathingCycle = Math.sin(time * 2);
                            if (i < 80) { // Chest
                                particle.position.multiplyScalar(1 + breathingCycle * 0.05);
                            }
                            
                            // Determined but shaky movement
                            particle.userData.velocity.x += Math.sin(time * 15 + i) * 0.001;
                            particle.userData.velocity.y += 0.002; // Still climbing up
                            
                            // Oxygen-deprived pale color
                            particle.material.color.setHSL(0.65, 0.3, 0.6 + breathingCycle * 0.1);
                            particle.material.opacity = 0.7 + Math.abs(breathingCycle) * 0.3;
                            
                            // Final push determination
                            if (i > 120 && i < 160 && phaseTimer > 4) { // Arms reaching for summit
                                particle.userData.targetPosition.y += 2;
                                particle.scale.setScalar(1.2);
                            }
                        });
                        
                        being.userData.basePosition.y += 0.015; // Slow final ascent
                        
                        // Dramatic final push camera
                        camera.position.set(0, being.userData.basePosition.y + 20, 40);
                        camera.lookAt(being.userData.basePosition);
                        break;
                        
                    case 6: // PEAK TRIUMPH - Expansive, victorious, panoramic view
                        being.particles.forEach((particle, i) => {
                            // Gradual expansion of triumph
                            const triumph = 1 + phaseTimer * 0.15;
                            particle.scale.setScalar(0.8 + triumph * 0.4);
                            
                            // Victory pose - arms raised
                            if (i > 100 && i < 150) {
                                particle.userData.targetPosition.y += triumph * 3;
                                particle.userData.targetPosition.x += Math.sin(i * 0.1) * triumph;
                            }
                            
                            // Triumphant expansion
                            particle.userData.targetPosition.multiplyScalar(1 + phaseTimer * 0.05);
                            
                            // Golden hour triumph color
                            particle.material.color.setHSL(
                                0.1 + Math.sin(time * 2) * 0.05,
                                0.8,
                                0.8 + Math.sin(time * 3 + i * 0.01) * 0.2
                            );
                            
                            // Rising energy
                            particle.userData.velocity.y += 0.001;
                            
                            // Victory sparkles
                            if (Math.random() < 0.08) {
                                createVictorySparkle(particle.position);
                            }
                        });
                        
                        being.userData.basePosition.y = Math.max(being.userData.basePosition.y, 15 + phaseTimer);
                        
                        // Epic panoramic summit camera
                        camera.position.set(
                            Math.sin(time * 0.5) * 60,
                            being.userData.basePosition.y + 20 + Math.sin(time * 0.3) * 10,
                            Math.cos(time * 0.5) * 60
                        );
                        camera.lookAt(being.userData.basePosition);
                        break;
                }
                
                updateMountainElements();
            };

            particleSystem.createAmbientParticles(120);
        }

        function createMountainEnvironment() {
            // Create mountain peaks
            for (let i = 0; i < 15; i++) {
                const peak = new THREE.Mesh(
                    new THREE.ConeGeometry(2 + Math.random() * 3, 8 + Math.random() * 12, 8),
                    new THREE.MeshBasicMaterial({
                        color: new THREE.Color().setHSL(0.1, 0.2, 0.3 + Math.random() * 0.3),
                        transparent: true,
                        opacity: 0.4
                    })
                );
                peak.position.set(
                    (Math.random() - 0.5) * 80,
                    -5 + Math.random() * 10,
                    -30 - Math.random() * 50
                );
                scene.add(peak);
                mountain.push(peak);
            }

            // Create rocks for climbing
            for (let i = 0; i < 12; i++) {
                const rock = new THREE.Mesh(
                    new THREE.BoxGeometry(1 + Math.random(), 1 + Math.random(), 1 + Math.random()),
                    new THREE.MeshBasicMaterial({
                        color: 0x696969,
                        transparent: true,
                        opacity: 0.6
                    })
                );
                rock.position.set(
                    (Math.random() - 0.5) * 20,
                    Math.random() * 20,
                    (Math.random() - 0.5) * 20
                );
                scene.add(rock);
                rocks.push(rock);
            }
        }

        function createGearItem(position) {
            const gearItem = new THREE.Mesh(
                new THREE.BoxGeometry(0.3, 0.1, 0.2),
                new THREE.MeshBasicMaterial({
                    color: new THREE.Color().setHSL(0.08, 0.7, 0.5),
                    transparent: true,
                    opacity: 0.8
                })
            );
            gearItem.position.copy(position);
            gearItem.position.add(new THREE.Vector3(
                (Math.random() - 0.5) * 3,
                Math.random() * 2,
                (Math.random() - 0.5) * 3
            ));
            gearItem.userData = { life: 0, spin: Math.random() * 0.1 };
            scene.add(gearItem);
            gear.push(gearItem);
        }

        function createHandhold(position) {
            const hold = new THREE.Mesh(
                new THREE.SphereGeometry(0.1, 6, 6),
                new THREE.MeshBasicMaterial({
                    color: 0x8b4513,
                    transparent: true,
                    opacity: 0.7
                })
            );
            hold.position.copy(position);
            hold.userData = { life: 0 };
            scene.add(hold);
            gear.push(hold);
        }

        function createBreathVapor(position) {
            const vapor = new THREE.Mesh(
                new THREE.SphereGeometry(0.2, 6, 6),
                new THREE.MeshBasicMaterial({
                    color: 0xffffff,
                    transparent: true,
                    opacity: 0.4
                })
            );
            vapor.position.copy(position);
            vapor.userData = { 
                life: 0,
                drift: new THREE.Vector3(0, 0.02, 0.01)
            };
            scene.add(vapor);
            weather.push(vapor);
        }

        function createAvalancheDebris(position) {
            const debris = new THREE.Mesh(
                new THREE.SphereGeometry(0.3 + Math.random() * 0.5, 4, 4),
                new THREE.MeshBasicMaterial({
                    color: 0xffffff,
                    transparent: true,
                    opacity: 0.8
                })
            );
            debris.position.copy(position);
            debris.position.add(new THREE.Vector3(
                (Math.random() - 0.5) * 5,
                Math.random() * 3,
                (Math.random() - 0.5) * 5
            ));
            debris.userData = { 
                life: 0,
                velocity: new THREE.Vector3(
                    (Math.random() - 0.5) * 0.2,
                    -Math.random() * 0.1,
                    Math.random() * 0.1
                )
            };
            scene.add(debris);
            weather.push(debris);
        }

        function createVictorySparkle(position) {
            const sparkle = new THREE.Mesh(
                new THREE.SphereGeometry(0.1, 4, 4),
                new THREE.MeshBasicMaterial({
                    color: 0xffd700,
                    transparent: true,
                    opacity: 1
                })
            );
            sparkle.position.copy(position);
            sparkle.userData = { 
                life: 0,
                rise: 0.03 + Math.random() * 0.02
            };
            scene.add(sparkle);
            gear.push(sparkle);
        }

        function updateMountainElements() {
            // Update gear and effects
            gear = gear.filter(item => {
                item.userData.life += 0.016;
                
                if (item.userData.spin) {
                    item.rotation.y += item.userData.spin;
                }
                
                if (item.userData.rise) {
                    item.position.y += item.userData.rise;
                }
                
                item.material.opacity = Math.max(0, item.material.opacity - 0.005);
                
                if (item.material.opacity <= 0) {
                    scene.remove(item);
                    return false;
                }
                return true;
            });

            // Update weather effects
            weather = weather.filter(effect => {
                effect.userData.life += 0.016;
                
                if (effect.userData.drift) {
                    effect.position.add(effect.userData.drift);
                }
                
                if (effect.userData.velocity) {
                    effect.position.add(effect.userData.velocity);
                    effect.userData.velocity.y -= 0.001; // Gravity
                }
                
                effect.material.opacity = Math.max(0, effect.material.opacity - 0.01);
                
                if (effect.material.opacity <= 0) {
                    scene.remove(effect);
                    return false;
                }
                return true;
            });
        }

        function animate() {
            requestAnimationFrame(animate);
            time += 0.016;

            particleSystem.update(0.016);
            
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>